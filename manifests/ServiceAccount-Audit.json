{
  "version": "1.0",
  "description": "Auto-generated from PowerShell module: ServiceAccount-Audit",
  "defaults": {
    "runtime": "powershell",
    "module": "C:/Users/larro/Projects/ServiceAccount-Audit"
  },
  "tools": [
    {
      "name": "Get-ServiceAccountAge",
      "description": "Analyzes service account password age and assigns risk ratings.",
      "function": "Get-ServiceAccountAge",
      "parameters": {
        "NamingPattern": {
          "type": "String",
          "description": "Comma-separated name patterns to match service accounts.\r\nDefault: \"svc*,service*\""
        },
        "SearchBase": {
          "type": "String",
          "description": "The AD distinguished name to scope the search. Defaults to the current domain root."
        },
        "DaysOldThreshold": {
          "type": "Int32",
          "description": "The minimum age in days to include in results. Default: 365.",
          "minimum": 1,
          "maximum": 2147483647
        }
      }
    },
    {
      "name": "Get-ServiceAccountInventory",
      "description": "Discovers service accounts in Active Directory.",
      "function": "Get-ServiceAccountInventory",
      "parameters": {
        "IncludeGMSA": {
          "type": "SwitchParameter",
          "description": "Include Group Managed Service Accounts (msDS-GroupManagedServiceAccount)."
        },
        "IncludeMSA": {
          "type": "SwitchParameter",
          "description": "Include Managed Service Accounts (msDS-ManagedServiceAccount)."
        },
        "SearchBase": {
          "type": "String",
          "description": "The AD distinguished name to scope the search. Defaults to the current domain root."
        },
        "NamingPattern": {
          "type": "String",
          "description": "Comma-separated name patterns to match service accounts.\r\nDefault: \"svc*,service*\""
        }
      }
    },
    {
      "name": "Get-ServiceAccountUsage",
      "description": "Scans remote servers to find where service accounts are actually running.",
      "function": "Get-ServiceAccountUsage",
      "parameters": {
        "ComputerName": {
          "type": "String[]",
          "description": "One or more server names to scan for running services. Mandatory.",
          "required": true
        },
        "SearchBase": {
          "type": "String",
          "description": "Optional AD search base to cross-reference discovered service accounts with\r\ntheir AD properties (password age, expiration policy, etc.)."
        }
      }
    },
    {
      "name": "Get-SPNReport",
      "description": "Audits Service Principal Names (SPNs) for Kerberoasting risk.",
      "function": "Get-SPNReport",
      "parameters": {
        "IncludeComputers": {
          "type": "SwitchParameter",
          "description": "Include computer accounts in the report. By default, only user accounts are returned\r\nsince computer accounts change their passwords automatically every 30 days."
        },
        "SearchBase": {
          "type": "String",
          "description": "The AD distinguished name to scope the search. Defaults to the current domain root."
        }
      }
    },
    {
      "name": "Invoke-ServiceAccountAudit",
      "description": "Orchestrates a full service account security audit and generates an HTML dashboard.",
      "function": "Invoke-ServiceAccountAudit",
      "parameters": {
        "ComputerName": {
          "type": "String[]",
          "description": "One or more server names to scan for running services. If omitted, the usage\r\nscan is skipped."
        },
        "OutputPath": {
          "type": "String",
          "description": "Path where the HTML report will be saved. Defaults to\r\n\"ServiceAccountAudit_<timestamp>.html\" in the current directory."
        },
        "IncludeMSA": {
          "type": "SwitchParameter",
          "description": "Include Managed Service Accounts in the inventory scan."
        },
        "SearchBase": {
          "type": "String",
          "description": "The AD distinguished name to scope the search. Defaults to the current domain root."
        },
        "DaysOldThreshold": {
          "type": "Int32",
          "description": "Minimum password age in days for the password age report. Default: 365.",
          "minimum": 1,
          "maximum": 2147483647
        }
      }
    }
  ]
}